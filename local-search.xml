<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>UCOSIII微秒延迟干扰时序问题</title>
    <link href="/2023/11/02/diary-20231102/"/>
    <url>/2023/11/02/diary-20231102/</url>
    
    <content type="html"><![CDATA[<h2 id="背景说明"><a href="#背景说明" class="headerlink" title="背景说明"></a>背景说明</h2><p>在之前用UCOS III做毕业设计的时候，课题要求为运用DS18B20测量温度并且实时在LCD上进行显示。代码烧录后发现温度测量不正常，但是裸机运行则温度测量正常，并且LCD显示屏初始化会导致线程卡死的状况。后一直在网上查找相关的解决方案，如图1所示。</p><span id="more"></span><p><img src="/assets/blogImg/P20231102/P20231102-02.png"><br><img src="/assets/blogImg/P20231102/P20231102-03.png"></p><center>图1 相关问题</center>Opendv论坛上有很多类似问题。捣鼓了几天，终于解决这个BUG。产生原因其实就是我一直引用正点原子的延迟库，正点原子的微妙延迟函数不太准问题。<h2 id="问题产生原因"><a href="#问题产生原因" class="headerlink" title="问题产生原因"></a>问题产生原因</h2><p>DS18B20为单总线通信，单总线通信设备内部有多个delay_us()不太适用于UCOS里使用，尤其是多任务的程序，因为没有时钟线来同步信号，所以任务切换的时候会干扰通信的时序。</p><h2 id="具体解决方法"><a href="#具体解决方法" class="headerlink" title="具体解决方法"></a>具体解决方法</h2><h3 id="临界区读取温度"><a href="#临界区读取温度" class="headerlink" title="临界区读取温度"></a>临界区读取温度</h3><p>如图2所示。<br><img src="/assets/blogImg/P20231102/P20231102-04.png"></p><center> 图2 临界区读取温度</center><h3 id="加入定时器重新定义微妙延迟函数，替换原有的所有微妙延迟函数"><a href="#加入定时器重新定义微妙延迟函数，替换原有的所有微妙延迟函数" class="headerlink" title="加入定时器重新定义微妙延迟函数，替换原有的所有微妙延迟函数"></a>加入定时器重新定义微妙延迟函数，替换原有的所有微妙延迟函数</h3><p>正点原子原始微妙延迟函数如图3所示，修改后的函数如图4图5所示。相关延迟函数文件下载在<a href="https://github.com/max123lgy/Delay">Github</a>。<br><img src="/assets/blogImg/P20231102/P20231102-05.png"></p><center> 图3 正点原子微妙函数</center><p><img src="/assets/blogImg/P20231102/P20231102-06.png"></p><center> 图4 定时器的初始化</center><p><img src="/assets/blogImg/P20231102/P20231102-05.png"></p><center> 图5 微妙延迟重新配置</center><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>基于UCOS的项目设计中应尽可能少使用单总线设备。多采用i2c通信设备设计方案。</p>]]></content>
    
    
    <categories>
      
      <category>嵌入式系统</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ucos</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>海岸线骑行</title>
    <link href="/2022/03/05/diary-20220305/"/>
    <url>/2022/03/05/diary-20220305/</url>
    
    <content type="html"><![CDATA[<p>这一周什么也没干就到周末了<br>我们几个小伙伴相约海岸线骑行<br>此行的目的地为–日月贝</p><span id="more"></span><p>没有过多的想法，骑骑车，赏赏风景！<br><img src="/assets/blogImg/P20220305/P20220305-02.jpg"><br><img src="/assets/blogImg/P20220305/P20220305-03.jpg"></p>]]></content>
    
    
    <categories>
      
      <category>旧事</category>
      
    </categories>
    
    
    <tags>
      
      <tag>珠海</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>来珠海之初</title>
    <link href="/2022/02/21/diary-20220227/"/>
    <url>/2022/02/21/diary-20220227/</url>
    
    <content type="html"><![CDATA[<p>要不要去实习？<br>这大概是每个毕业生都在忧虑的事情吧。<br>在临近毕业自己却倍感忧虑，<br>在无数的灵魂逼问下，我独自走上实习之旅。</p><span id="more"></span><p><img src="/assets/blogImg/P20220227/zhuhai.jpg"><br>刚刚下了珠海北站，离公司还有2km的路程吧，坐上K1公交，来到公司宿舍楼下已经是傍晚。<br>跟保安沟通了一会，拿上钥匙，径直的向宿舍走去，<br>打开宿舍门，遇上了热心的同事，<br>他叫双宝，但好多次我都把他叫成了多宝，嘻嘻，也许是加多宝的缘故吧。<br>他细心的给我讲述了公司的具体现状以及上班安排，<br>我就像刚刚上学的孩子一样，对未知事物的渴望。<br>而后认识了部门同事高泽，<br>也许是个人的原因，刚刚步入这块宝地，心里避免不了的忧伤！<br>每天开始我的实习之旅吧。。。加油！</p>]]></content>
    
    
    <categories>
      
      <category>旧事</category>
      
    </categories>
    
    
    <tags>
      
      <tag>实习</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>HEXO常用命令</title>
    <link href="/2021/10/01/diary-20211001/"/>
    <url>/2021/10/01/diary-20211001/</url>
    
    <content type="html"><![CDATA[<blockquote><p>常用命令</p></blockquote><span id="more"></span><figure class="highlight axapta"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs axapta">hexo <span class="hljs-keyword">new</span> <span class="hljs-string">&quot;postName&quot;</span> <span class="hljs-meta">#新建文章</span><br>hexo <span class="hljs-keyword">new</span> page <span class="hljs-string">&quot;pageName&quot;</span> <span class="hljs-meta">#新建页面</span><br>hexo generate <span class="hljs-meta">#生成静态页面至public目录</span><br>hexo <span class="hljs-keyword">server</span> <span class="hljs-meta">#开启预览访问端口（默认端口4000，&#x27;ctrl + c&#x27;关闭server）</span><br>hexo deploy <span class="hljs-meta">#部署到GitHub</span><br>hexo help  <span class="hljs-meta"># 查看帮助</span><br>hexo version  <span class="hljs-meta">#查看Hexo的版本</span><br></code></pre></td></tr></table></figure><blockquote><p>缩写</p></blockquote><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs abnf">hexo n <span class="hljs-operator">=</span><span class="hljs-operator">=</span> hexo new<br>hexo g <span class="hljs-operator">=</span><span class="hljs-operator">=</span> hexo generate<br>hexo s <span class="hljs-operator">=</span><span class="hljs-operator">=</span> hexo server<br>hexo d <span class="hljs-operator">=</span><span class="hljs-operator">=</span> hexo deploy<br><br></code></pre></td></tr></table></figure><blockquote><p>组合命令</p></blockquote><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-attribute">hexo</span> s -g <span class="hljs-comment">#生成并本地预览</span><br>hexo d -g <span class="hljs-comment">#生成并上传</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>杂谈</category>
      
    </categories>
    
    
    <tags>
      
      <tag>hexo</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>据说</title>
    <link href="/2021/07/01/diary-20210701/"/>
    <url>/2021/07/01/diary-20210701/</url>
    
    <content type="html"><![CDATA[<p>星期五的早上<br>阿狸把白己夹在晾衣服的绳子上，想把耳朵拉长. . .</p><span id="more"></span><p><img src="/%5Cassets%5CblogImg%5CP20210701%5C20210701-Ali.jpg"></p><p>据说是因为他爱上了那只免子<br>但是，那只免子并不爱他 兔子喝N加仑的咖啡，听摇滚的high歌，几天几夜地不睡觉 据说是因为她爱上了那只熊猫</p><p>但是熊猫一点都不care她<br>熊猫想用弹弓把自己弹到天上去<br>据说他爱上了隔壁的麻雀</p><p>但是，麻雀觉得熊猫一点都没品味<br>麻雀学游泳，争取每天能憋气多一分钟<br>据说他爱上了小鱼</p><p>但是，小鱼觉得麻雀特别trouble<br>小鱼整天吹泡泡<br>很明显，她爱上了阿狸</p><p>所以呢，后面的每一段爱情故事就这样悲伤的循环下去. . .</p>]]></content>
    
    
    <categories>
      
      <category>杂谈</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Ali</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>小陆的个人博客搭建</title>
    <link href="/2021/06/28/diary-20210628-20211001/"/>
    <url>/2021/06/28/diary-20210628-20211001/</url>
    
    <content type="html"><![CDATA[<p><img src="/assets/blogImg/blog.png"><br>又重新搭建了一下个人博客，这次使用的是<a href="https://github.com/fluid-dev/hexo-theme-fluid">Fluid主题</a>。</p><span id="more"></span><p>搭建这个博客折腾了几天时间，在github page上看到自己的博客加载下来时，突然有种错综复杂的恍惚感。是的，它不是qq空间，不是新浪博客，不是豆瓣小站，也不是贴吧。它更像是属于自己的一块小小的领地，因而我满足于这种归属感,我愿在上面安静劳作。</p><p>一个农民，通过自身努力终于分到了一块地，不再需要在地主的土地上创造流量价值时，于是翻身作主的他可以宣告说：Hello World。</p><p>感谢<a href="https://hexo.io/">hexo</a>提供的Fluid主题，我很喜欢这种风格色调。</p>]]></content>
    
    
    <categories>
      
      <category>杂谈</category>
      
    </categories>
    
    
    <tags>
      
      <tag>hexo</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
